warning: `VIRTUAL_ENV=/usr` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
05:15:41 HTTP Request: HEAD https://huggingface.co/meta-llama/Llama-3.1-8B-Instruct/resolve/main/config.json "HTTP/1.1 200 OK"
05:15:41 HTTP Request: HEAD https://huggingface.co/meta-llama/Llama-3.1-8B-Instruct/resolve/main/tokenizer_config.json "HTTP/1.1 200 OK"
05:15:41 HTTP Request: HEAD https://huggingface.co/meta-llama/Llama-3.1-8B-Instruct/resolve/main/tokenizer_config.json "HTTP/1.1 200 OK"
05:15:42 HTTP Request: GET https://huggingface.co/api/models/meta-llama/Llama-3.1-8B-Instruct/tree/main/additional_chat_templates?recursive=false&expand=false "HTTP/1.1 404 Not Found"
05:15:42 HTTP Request: GET https://huggingface.co/api/models/meta-llama/Llama-3.1-8B-Instruct/tree/main?recursive=true&expand=false "HTTP/1.1 200 OK"
05:15:43 HTTP Request: GET https://huggingface.co/api/models/meta-llama/Llama-3.1-8B-Instruct "HTTP/1.1 200 OK"
05:15:44 HTTP Request: HEAD https://huggingface.co/meta-llama/Llama-3.1-8B-Instruct/resolve/main/config.json "HTTP/1.1 200 OK"
`torch_dtype` is deprecated! Use `dtype` instead!
Loading weights:   0%|          | 0/291 [00:00<?, ?it/s]Loading weights:   0%|          | 1/291 [00:00<00:00, 10485.76it/s, Materializing param=lm_head.weight]Loading weights:   0%|          | 1/291 [00:00<00:00, 4253.86it/s, Materializing param=lm_head.weight] Loading weights:   1%|          | 2/291 [00:04<11:05,  2.30s/it, Materializing param=lm_head.weight]  Loading weights:   1%|          | 2/291 [00:04<11:05,  2.30s/it, Materializing param=model.embed_tokens.weight]Loading weights:   1%|          | 2/291 [00:04<11:05,  2.30s/it, Materializing param=model.embed_tokens.weight]Loading weights:   1%|          | 3/291 [00:09<15:56,  3.32s/it, Materializing param=model.embed_tokens.weight]Loading weights:   1%|          | 3/291 [00:09<15:56,  3.32s/it, Materializing param=model.layers.0.input_layernorm.weight]Loading weights:   1%|          | 3/291 [00:09<15:56,  3.32s/it, Materializing param=model.layers.0.input_layernorm.weight]Loading weights:   1%|▏         | 4/291 [00:09<15:53,  3.32s/it, Materializing param=model.layers.0.mlp.down_proj.weight]  Loading weights:   1%|▏         | 4/291 [00:09<15:53,  3.32s/it, Materializing param=model.layers.0.mlp.down_proj.weight]Loading weights:   2%|▏         | 5/291 [00:15<14:53,  3.12s/it, Materializing param=model.layers.0.mlp.down_proj.weight]Loading weights:   2%|▏         | 5/291 [00:15<14:53,  3.12s/it, Materializing param=model.layers.0.mlp.gate_proj.weight]Loading weights:   2%|▏         | 5/291 [00:15<14:53,  3.12s/it, Materializing param=model.layers.0.mlp.gate_proj.weight]Loading weights:   2%|▏         | 6/291 [00:20<18:07,  3.82s/it, Materializing param=model.layers.0.mlp.gate_proj.weight]Loading weights:   2%|▏         | 6/291 [00:20<18:07,  3.82s/it, Materializing param=model.layers.0.mlp.up_proj.weight]  Loading weights:   2%|▏         | 6/291 [00:20<18:07,  3.82s/it, Materializing param=model.layers.0.mlp.up_proj.weight]Loading weights:   2%|▏         | 7/291 [00:26<21:03,  4.45s/it, Materializing param=model.layers.0.mlp.up_proj.weight]Loading weights:   2%|▏         | 7/291 [00:26<21:03,  4.45s/it, Materializing param=model.layers.0.post_attention_layernorm.weight]Loading weights:   2%|▏         | 7/291 [00:26<21:03,  4.45s/it, Materializing param=model.layers.0.post_attention_layernorm.weight]Loading weights:   3%|▎         | 8/291 [00:26<20:59,  4.45s/it, Materializing param=model.layers.0.self_attn.k_proj.weight]        Loading weights:   3%|▎         | 8/291 [00:26<20:59,  4.45s/it, Materializing param=model.layers.0.self_attn.k_proj.weight]Loading weights:   3%|▎         | 9/291 [00:32<17:49,  3.79s/it, Materializing param=model.layers.0.self_attn.k_proj.weight]Loading weights:   3%|▎         | 9/291 [00:32<17:49,  3.79s/it, Materializing param=model.layers.0.self_attn.o_proj.weight]Loading weights:   3%|▎         | 9/291 [00:32<17:49,  3.79s/it, Materializing param=model.layers.0.self_attn.o_proj.weight]Loading weights:   3%|▎         | 10/291 [00:42<24:23,  5.21s/it, Materializing param=model.layers.0.self_attn.o_proj.weight]Loading weights:   3%|▎         | 10/291 [00:42<24:23,  5.21s/it, Materializing param=model.layers.0.self_attn.q_proj.weight]Loading weights:   3%|▎         | 10/291 [00:42<24:23,  5.21s/it, Materializing param=model.layers.0.self_attn.q_proj.weight]Loading weights:   4%|▍         | 11/291 [00:50<27:07,  5.81s/it, Materializing param=model.layers.0.self_attn.q_proj.weight]Loading weights:   4%|▍         | 11/291 [00:50<27:07,  5.81s/it, Materializing param=model.layers.0.self_attn.v_proj.weight]Loading weights:   4%|▍         | 11/291 [00:50<27:07,  5.81s/it, Materializing param=model.layers.0.self_attn.v_proj.weight]Loading weights:   4%|▍         | 12/291 [00:53<23:39,  5.09s/it, Materializing param=model.layers.0.self_attn.v_proj.weight]Loading weights:   4%|▍         | 12/291 [00:53<23:39,  5.09s/it, Materializing param=model.layers.1.input_layernorm.weight] Loading weights:   4%|▍         | 12/291 [00:53<23:39,  5.09s/it, Materializing param=model.layers.1.input_layernorm.weight]Loading weights:   4%|▍         | 13/291 [00:53<23:34,  5.09s/it, Materializing param=model.layers.1.mlp.down_proj.weight]  Loading weights:   4%|▍         | 13/291 [00:53<23:34,  5.09s/it, Materializing param=model.layers.1.mlp.down_proj.weight]Loading weights:   5%|▍         | 14/291 [00:53<23:29,  5.09s/it, Materializing param=model.layers.1.mlp.gate_proj.weight]Loading weights:   5%|▍         | 14/291 [00:53<23:29,  5.09s/it, Materializing param=model.layers.1.mlp.gate_proj.weight]Loading weights:   5%|▌         | 15/291 [00:53<23:24,  5.09s/it, Materializing param=model.layers.1.mlp.up_proj.weight]  Loading weights:   5%|▌         | 15/291 [00:53<23:24,  5.09s/it, Materializing param=model.layers.1.mlp.up_proj.weight]Loading weights:   5%|▌         | 16/291 [00:53<23:19,  5.09s/it, Materializing param=model.layers.1.post_attention_layernorm.weight]Loading weights:   5%|▌         | 16/291 [00:53<23:19,  5.09s/it, Materializing param=model.layers.1.post_attention_layernorm.weight]Loading weights:   6%|▌         | 17/291 [00:53<23:14,  5.09s/it, Materializing param=model.layers.1.self_attn.k_proj.weight]        Loading weights:   6%|▌         | 17/291 [00:53<23:14,  5.09s/it, Materializing param=model.layers.1.self_attn.k_proj.weight]Loading weights:   6%|▌         | 18/291 [00:53<23:09,  5.09s/it, Materializing param=model.layers.1.self_attn.o_proj.weight]Loading weights:   6%|▌         | 18/291 [00:53<23:09,  5.09s/it, Materializing param=model.layers.1.self_attn.o_proj.weight]Loading weights:   7%|▋         | 19/291 [00:53<23:03,  5.09s/it, Materializing param=model.layers.1.self_attn.q_proj.weight]Loading weights:   7%|▋         | 19/291 [00:53<23:03,  5.09s/it, Materializing param=model.layers.1.self_attn.q_proj.weight]Loading weights:   7%|▋         | 20/291 [00:53<05:41,  1.26s/it, Materializing param=model.layers.1.self_attn.q_proj.weight]Loading weights:   7%|▋         | 20/291 [00:53<05:41,  1.26s/it, Materializing param=model.layers.1.self_attn.v_proj.weight]Loading weights:   7%|▋         | 20/291 [00:53<05:41,  1.26s/it, Materializing param=model.layers.1.self_attn.v_proj.weight]Loading weights:   7%|▋         | 21/291 [00:53<05:39,  1.26s/it, Materializing param=model.layers.2.input_layernorm.weight] Loading weights:   7%|▋         | 21/291 [00:53<05:39,  1.26s/it, Materializing param=model.layers.2.input_layernorm.weight]Loading weights:   8%|▊         | 22/291 [00:53<05:38,  1.26s/it, Materializing param=model.layers.2.mlp.down_proj.weight]  Loading weights:   8%|▊         | 22/291 [00:53<05:38,  1.26s/it, Materializing param=model.layers.2.mlp.down_proj.weight]Loading weights:   8%|▊         | 23/291 [00:53<05:37,  1.26s/it, Materializing param=model.layers.2.mlp.gate_proj.weight]Loading weights:   8%|▊         | 23/291 [00:53<05:37,  1.26s/it, Materializing param=model.layers.2.mlp.gate_proj.weight]Loading weights:   8%|▊         | 24/291 [00:53<05:35,  1.26s/it, Materializing param=model.layers.2.mlp.up_proj.weight]  Loading weights:   8%|▊         | 24/291 [00:53<05:35,  1.26s/it, Materializing param=model.layers.2.mlp.up_proj.weight]Loading weights:   9%|▊         | 25/291 [00:53<05:34,  1.26s/it, Materializing param=model.layers.2.post_attention_layernorm.weight]Loading weights:   9%|▊         | 25/291 [00:53<05:34,  1.26s/it, Materializing param=model.layers.2.post_attention_layernorm.weight]Loading weights:   9%|▉         | 26/291 [00:53<05:33,  1.26s/it, Materializing param=model.layers.2.self_attn.k_proj.weight]        Loading weights:   9%|▉         | 26/291 [00:53<05:33,  1.26s/it, Materializing param=model.layers.2.self_attn.k_proj.weight]Loading weights:   9%|▉         | 27/291 [00:53<05:32,  1.26s/it, Materializing param=model.layers.2.self_attn.o_proj.weight]Loading weights:   9%|▉         | 27/291 [00:53<05:32,  1.26s/it, Materializing param=model.layers.2.self_attn.o_proj.weight]Loading weights:  10%|▉         | 28/291 [00:53<05:30,  1.26s/it, Materializing param=model.layers.2.self_attn.q_proj.weight]Loading weights:  10%|▉         | 28/291 [00:53<05:30,  1.26s/it, Materializing param=model.layers.2.self_attn.q_proj.weight]Loading weights:  10%|▉         | 29/291 [00:53<05:29,  1.26s/it, Materializing param=model.layers.2.self_attn.v_proj.weight]Loading weights:  10%|▉         | 29/291 [00:53<05:29,  1.26s/it, Materializing param=model.layers.2.self_attn.v_proj.weight]Loading weights:  10%|█         | 30/291 [00:53<05:28,  1.26s/it, Materializing param=model.layers.3.input_layernorm.weight] Loading weights:  10%|█         | 30/291 [00:53<05:28,  1.26s/it, Materializing param=model.layers.3.input_layernorm.weight]Loading weights:  11%|█         | 31/291 [00:53<05:27,  1.26s/it, Materializing param=model.layers.3.mlp.down_proj.weight]  Loading weights:  11%|█         | 31/291 [00:53<05:27,  1.26s/it, Materializing param=model.layers.3.mlp.down_proj.weight]Loading weights:  11%|█         | 32/291 [00:53<05:25,  1.26s/it, Materializing param=model.layers.3.mlp.gate_proj.weight]Loading weights:  11%|█         | 32/291 [00:53<05:25,  1.26s/it, Materializing param=model.layers.3.mlp.gate_proj.weight]Loading weights:  11%|█▏        | 33/291 [00:53<05:24,  1.26s/it, Materializing param=model.layers.3.mlp.up_proj.weight]  Loading weights:  11%|█▏        | 33/291 [00:53<05:24,  1.26s/it, Materializing param=model.layers.3.mlp.up_proj.weight]Loading weights:  12%|█▏        | 34/291 [00:53<05:23,  1.26s/it, Materializing param=model.layers.3.post_attention_layernorm.weight]Loading weights:  12%|█▏        | 34/291 [00:53<05:23,  1.26s/it, Materializing param=model.layers.3.post_attention_layernorm.weight]Loading weights:  12%|█▏        | 35/291 [00:53<05:22,  1.26s/it, Materializing param=model.layers.3.self_attn.k_proj.weight]        Loading weights:  12%|█▏        | 35/291 [00:53<05:22,  1.26s/it, Materializing param=model.layers.3.self_attn.k_proj.weight]Loading weights:  12%|█▏        | 36/291 [00:53<05:20,  1.26s/it, Materializing param=model.layers.3.self_attn.o_proj.weight]Loading weights:  12%|█▏        | 36/291 [00:53<05:20,  1.26s/it, Materializing param=model.layers.3.self_attn.o_proj.weight]Loading weights:  13%|█▎        | 37/291 [00:53<05:19,  1.26s/it, Materializing param=model.layers.3.self_attn.q_proj.weight]Loading weights:  13%|█▎        | 37/291 [00:53<05:19,  1.26s/it, Materializing param=model.layers.3.self_attn.q_proj.weight]Loading weights:  13%|█▎        | 38/291 [00:53<05:18,  1.26s/it, Materializing param=model.layers.3.self_attn.v_proj.weight]Loading weights:  13%|█▎        | 38/291 [00:53<05:18,  1.26s/it, Materializing param=model.layers.3.self_attn.v_proj.weight]Loading weights:  13%|█▎        | 39/291 [00:53<05:17,  1.26s/it, Materializing param=model.layers.4.input_layernorm.weight] Loading weights:  13%|█▎        | 39/291 [00:53<05:17,  1.26s/it, Materializing param=model.layers.4.input_layernorm.weight]Loading weights:  14%|█▎        | 40/291 [00:53<05:15,  1.26s/it, Materializing param=model.layers.4.mlp.down_proj.weight]  Loading weights:  14%|█▎        | 40/291 [00:53<05:15,  1.26s/it, Materializing param=model.layers.4.mlp.down_proj.weight]Loading weights:  14%|█▍        | 41/291 [00:53<05:14,  1.26s/it, Materializing param=model.layers.4.mlp.gate_proj.weight]Loading weights:  14%|█▍        | 41/291 [00:53<05:14,  1.26s/it, Materializing param=model.layers.4.mlp.gate_proj.weight]Loading weights:  14%|█▍        | 42/291 [00:53<05:13,  1.26s/it, Materializing param=model.layers.4.mlp.up_proj.weight]  Loading weights:  14%|█▍        | 42/291 [00:53<05:13,  1.26s/it, Materializing param=model.layers.4.mlp.up_proj.weight]Loading weights:  15%|█▍        | 43/291 [00:53<05:12,  1.26s/it, Materializing param=model.layers.4.post_attention_layernorm.weight]Loading weights:  15%|█▍        | 43/291 [00:53<05:12,  1.26s/it, Materializing param=model.layers.4.post_attention_layernorm.weight]Loading weights:  15%|█▌        | 44/291 [00:53<05:10,  1.26s/it, Materializing param=model.layers.4.self_attn.k_proj.weight]        Loading weights:  15%|█▌        | 44/291 [00:53<05:10,  1.26s/it, Materializing param=model.layers.4.self_attn.k_proj.weight]Loading weights:  15%|█▌        | 45/291 [00:53<05:09,  1.26s/it, Materializing param=model.layers.4.self_attn.o_proj.weight]Loading weights:  15%|█▌        | 45/291 [00:53<05:09,  1.26s/it, Materializing param=model.layers.4.self_attn.o_proj.weight]Loading weights:  16%|█▌        | 46/291 [00:53<05:08,  1.26s/it, Materializing param=model.layers.4.self_attn.q_proj.weight]Loading weights:  16%|█▌        | 46/291 [00:53<05:08,  1.26s/it, Materializing param=model.layers.4.self_attn.q_proj.weight]Loading weights:  16%|█▌        | 47/291 [00:53<05:07,  1.26s/it, Materializing param=model.layers.4.self_attn.v_proj.weight]Loading weights:  16%|█▌        | 47/291 [00:53<05:07,  1.26s/it, Materializing param=model.layers.4.self_attn.v_proj.weight]Loading weights:  16%|█▋        | 48/291 [00:53<05:05,  1.26s/it, Materializing param=model.layers.5.input_layernorm.weight] Loading weights:  16%|█▋        | 48/291 [00:53<05:05,  1.26s/it, Materializing param=model.layers.5.input_layernorm.weight]Loading weights:  17%|█▋        | 49/291 [00:53<05:04,  1.26s/it, Materializing param=model.layers.5.mlp.down_proj.weight]  Loading weights:  17%|█▋        | 49/291 [00:53<05:04,  1.26s/it, Materializing param=model.layers.5.mlp.down_proj.weight]Loading weights:  17%|█▋        | 50/291 [00:53<05:03,  1.26s/it, Materializing param=model.layers.5.mlp.gate_proj.weight]Loading weights:  17%|█▋        | 50/291 [00:53<05:03,  1.26s/it, Materializing param=model.layers.5.mlp.gate_proj.weight]Loading weights:  18%|█▊        | 51/291 [00:53<05:01,  1.26s/it, Materializing param=model.layers.5.mlp.up_proj.weight]  Loading weights:  18%|█▊        | 51/291 [00:53<05:01,  1.26s/it, Materializing param=model.layers.5.mlp.up_proj.weight]Loading weights:  18%|█▊        | 52/291 [00:53<05:00,  1.26s/it, Materializing param=model.layers.5.post_attention_layernorm.weight]Loading weights:  18%|█▊        | 52/291 [00:53<05:00,  1.26s/it, Materializing param=model.layers.5.post_attention_layernorm.weight]Loading weights:  18%|█▊        | 53/291 [00:53<04:59,  1.26s/it, Materializing param=model.layers.5.self_attn.k_proj.weight]        Loading weights:  18%|█▊        | 53/291 [00:53<04:59,  1.26s/it, Materializing param=model.layers.5.self_attn.k_proj.weight]Loading weights:  19%|█▊        | 54/291 [00:53<04:58,  1.26s/it, Materializing param=model.layers.5.self_attn.o_proj.weight]Loading weights:  19%|█▊        | 54/291 [00:53<04:58,  1.26s/it, Materializing param=model.layers.5.self_attn.o_proj.weight]Loading weights:  19%|█▉        | 55/291 [00:53<04:56,  1.26s/it, Materializing param=model.layers.5.self_attn.q_proj.weight]Loading weights:  19%|█▉        | 55/291 [00:53<04:56,  1.26s/it, Materializing param=model.layers.5.self_attn.q_proj.weight]Loading weights:  19%|█▉        | 56/291 [00:53<04:55,  1.26s/it, Materializing param=model.layers.5.self_attn.v_proj.weight]Loading weights:  19%|█▉        | 56/291 [00:53<04:55,  1.26s/it, Materializing param=model.layers.5.self_attn.v_proj.weight]Loading weights:  20%|█▉        | 57/291 [00:53<04:54,  1.26s/it, Materializing param=model.layers.6.input_layernorm.weight] Loading weights:  20%|█▉        | 57/291 [00:53<04:54,  1.26s/it, Materializing param=model.layers.6.input_layernorm.weight]Loading weights:  20%|█▉        | 58/291 [00:53<04:53,  1.26s/it, Materializing param=model.layers.6.mlp.down_proj.weight]  Loading weights:  20%|█▉        | 58/291 [00:53<04:53,  1.26s/it, Materializing param=model.layers.6.mlp.down_proj.weight]Loading weights:  20%|██        | 59/291 [00:53<04:51,  1.26s/it, Materializing param=model.layers.6.mlp.gate_proj.weight]Loading weights:  20%|██        | 59/291 [00:53<04:51,  1.26s/it, Materializing param=model.layers.6.mlp.gate_proj.weight]Loading weights:  21%|██        | 60/291 [00:53<04:50,  1.26s/it, Materializing param=model.layers.6.mlp.up_proj.weight]  Loading weights:  21%|██        | 60/291 [00:53<04:50,  1.26s/it, Materializing param=model.layers.6.mlp.up_proj.weight]Loading weights:  21%|██        | 61/291 [00:53<04:49,  1.26s/it, Materializing param=model.layers.6.post_attention_layernorm.weight]Loading weights:  21%|██        | 61/291 [00:53<04:49,  1.26s/it, Materializing param=model.layers.6.post_attention_layernorm.weight]Loading weights:  21%|██▏       | 62/291 [00:53<04:48,  1.26s/it, Materializing param=model.layers.6.self_attn.k_proj.weight]        Loading weights:  21%|██▏       | 62/291 [00:53<04:48,  1.26s/it, Materializing param=model.layers.6.self_attn.k_proj.weight]Loading weights:  22%|██▏       | 63/291 [00:53<04:46,  1.26s/it, Materializing param=model.layers.6.self_attn.o_proj.weight]Loading weights:  22%|██▏       | 63/291 [00:53<04:46,  1.26s/it, Materializing param=model.layers.6.self_attn.o_proj.weight]Loading weights:  22%|██▏       | 64/291 [00:53<04:45,  1.26s/it, Materializing param=model.layers.6.self_attn.q_proj.weight]Loading weights:  22%|██▏       | 64/291 [00:53<04:45,  1.26s/it, Materializing param=model.layers.6.self_attn.q_proj.weight]Loading weights:  22%|██▏       | 65/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.6.self_attn.q_proj.weight]Loading weights:  22%|██▏       | 65/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.6.self_attn.v_proj.weight]Loading weights:  22%|██▏       | 65/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.6.self_attn.v_proj.weight]Loading weights:  23%|██▎       | 66/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.7.input_layernorm.weight] Loading weights:  23%|██▎       | 66/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.7.input_layernorm.weight]Loading weights:  23%|██▎       | 67/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.7.mlp.down_proj.weight]  Loading weights:  23%|██▎       | 67/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.7.mlp.down_proj.weight]Loading weights:  23%|██▎       | 68/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.7.mlp.gate_proj.weight]Loading weights:  23%|██▎       | 68/291 [00:53<00:40,  5.55it/s, Materializing param=model.layers.7.mlp.gate_proj.weight]Loading weights:  24%|██▎       | 69/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.mlp.up_proj.weight]  Loading weights:  24%|██▎       | 69/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.mlp.up_proj.weight]Loading weights:  24%|██▍       | 70/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.post_attention_layernorm.weight]Loading weights:  24%|██▍       | 70/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.post_attention_layernorm.weight]Loading weights:  24%|██▍       | 71/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.k_proj.weight]        Loading weights:  24%|██▍       | 71/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.k_proj.weight]Loading weights:  25%|██▍       | 72/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.o_proj.weight]Loading weights:  25%|██▍       | 72/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.o_proj.weight]Loading weights:  25%|██▌       | 73/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.q_proj.weight]Loading weights:  25%|██▌       | 73/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.q_proj.weight]Loading weights:  25%|██▌       | 74/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.v_proj.weight]Loading weights:  25%|██▌       | 74/291 [00:53<00:39,  5.55it/s, Materializing param=model.layers.7.self_attn.v_proj.weight]Loading weights:  26%|██▌       | 75/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.input_layernorm.weight] Loading weights:  26%|██▌       | 75/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.input_layernorm.weight]Loading weights:  26%|██▌       | 76/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.mlp.down_proj.weight]  Loading weights:  26%|██▌       | 76/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.mlp.down_proj.weight]Loading weights:  26%|██▋       | 77/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.mlp.gate_proj.weight]Loading weights:  26%|██▋       | 77/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.mlp.gate_proj.weight]Loading weights:  27%|██▋       | 78/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.mlp.up_proj.weight]  Loading weights:  27%|██▋       | 78/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.mlp.up_proj.weight]Loading weights:  27%|██▋       | 79/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.post_attention_layernorm.weight]Loading weights:  27%|██▋       | 79/291 [00:53<00:38,  5.55it/s, Materializing param=model.layers.8.post_attention_layernorm.weight]Loading weights:  27%|██▋       | 80/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.k_proj.weight]        Loading weights:  27%|██▋       | 80/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.k_proj.weight]Loading weights:  28%|██▊       | 81/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.o_proj.weight]Loading weights:  28%|██▊       | 81/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.o_proj.weight]Loading weights:  28%|██▊       | 82/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.q_proj.weight]Loading weights:  28%|██▊       | 82/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.q_proj.weight]Loading weights:  29%|██▊       | 83/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.v_proj.weight]Loading weights:  29%|██▊       | 83/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.8.self_attn.v_proj.weight]Loading weights:  29%|██▉       | 84/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.9.input_layernorm.weight] Loading weights:  29%|██▉       | 84/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.9.input_layernorm.weight]Loading weights:  29%|██▉       | 85/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.9.mlp.down_proj.weight]  Loading weights:  29%|██▉       | 85/291 [00:53<00:37,  5.55it/s, Materializing param=model.layers.9.mlp.down_proj.weight]Loading weights:  30%|██▉       | 86/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.mlp.gate_proj.weight]Loading weights:  30%|██▉       | 86/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.mlp.gate_proj.weight]Loading weights:  30%|██▉       | 87/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.mlp.up_proj.weight]  Loading weights:  30%|██▉       | 87/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.mlp.up_proj.weight]Loading weights:  30%|███       | 88/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.post_attention_layernorm.weight]Loading weights:  30%|███       | 88/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.post_attention_layernorm.weight]Loading weights:  31%|███       | 89/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.self_attn.k_proj.weight]        Loading weights:  31%|███       | 89/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.self_attn.k_proj.weight]Loading weights:  31%|███       | 90/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.self_attn.o_proj.weight]Loading weights:  31%|███       | 90/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.self_attn.o_proj.weight]Loading weights:  31%|███▏      | 91/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.self_attn.q_proj.weight]Loading weights:  31%|███▏      | 91/291 [00:53<00:36,  5.55it/s, Materializing param=model.layers.9.self_attn.q_proj.weight]Loading weights:  32%|███▏      | 92/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.9.self_attn.v_proj.weight]Loading weights:  32%|███▏      | 92/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.9.self_attn.v_proj.weight]Loading weights:  32%|███▏      | 93/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.input_layernorm.weight]Loading weights:  32%|███▏      | 93/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.input_layernorm.weight]Loading weights:  32%|███▏      | 94/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.mlp.down_proj.weight]  Loading weights:  32%|███▏      | 94/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.mlp.down_proj.weight]Loading weights:  33%|███▎      | 95/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.mlp.gate_proj.weight]Loading weights:  33%|███▎      | 95/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.mlp.gate_proj.weight]Loading weights:  33%|███▎      | 96/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.mlp.up_proj.weight]  Loading weights:  33%|███▎      | 96/291 [00:53<00:35,  5.55it/s, Materializing param=model.layers.10.mlp.up_proj.weight]Loading weights:  33%|███▎      | 97/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.post_attention_layernorm.weight]Loading weights:  33%|███▎      | 97/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.post_attention_layernorm.weight]Loading weights:  34%|███▎      | 98/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.k_proj.weight]        Loading weights:  34%|███▎      | 98/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.k_proj.weight]Loading weights:  34%|███▍      | 99/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.o_proj.weight]Loading weights:  34%|███▍      | 99/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.o_proj.weight]Loading weights:  34%|███▍      | 100/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.q_proj.weight]Loading weights:  34%|███▍      | 100/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.q_proj.weight]Loading weights:  35%|███▍      | 101/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.v_proj.weight]Loading weights:  35%|███▍      | 101/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.10.self_attn.v_proj.weight]Loading weights:  35%|███▌      | 102/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.11.input_layernorm.weight] Loading weights:  35%|███▌      | 102/291 [00:53<00:34,  5.55it/s, Materializing param=model.layers.11.input_layernorm.weight]Loading weights:  35%|███▌      | 103/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.mlp.down_proj.weight]  Loading weights:  35%|███▌      | 103/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.mlp.down_proj.weight]Loading weights:  36%|███▌      | 104/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.mlp.gate_proj.weight]Loading weights:  36%|███▌      | 104/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.mlp.gate_proj.weight]Loading weights:  36%|███▌      | 105/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.mlp.up_proj.weight]  Loading weights:  36%|███▌      | 105/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.mlp.up_proj.weight]Loading weights:  36%|███▋      | 106/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.post_attention_layernorm.weight]Loading weights:  36%|███▋      | 106/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.post_attention_layernorm.weight]Loading weights:  37%|███▋      | 107/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.self_attn.k_proj.weight]        Loading weights:  37%|███▋      | 107/291 [00:53<00:33,  5.55it/s, Materializing param=model.layers.11.self_attn.k_proj.weight]Loading weights:  37%|███▋      | 108/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.11.self_attn.o_proj.weight]Loading weights:  37%|███▋      | 108/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.11.self_attn.o_proj.weight]Loading weights:  37%|███▋      | 109/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.11.self_attn.q_proj.weight]Loading weights:  37%|███▋      | 109/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.11.self_attn.q_proj.weight]Loading weights:  38%|███▊      | 110/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.11.self_attn.v_proj.weight]Loading weights:  38%|███▊      | 110/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.11.self_attn.v_proj.weight]Loading weights:  38%|███▊      | 111/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.12.input_layernorm.weight] Loading weights:  38%|███▊      | 111/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.12.input_layernorm.weight]Loading weights:  38%|███▊      | 112/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.12.mlp.down_proj.weight]  Loading weights:  38%|███▊      | 112/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.12.mlp.down_proj.weight]Loading weights:  39%|███▉      | 113/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.12.mlp.gate_proj.weight]Loading weights:  39%|███▉      | 113/291 [00:53<00:32,  5.55it/s, Materializing param=model.layers.12.mlp.gate_proj.weight]Loading weights:  39%|███▉      | 114/291 [00:53<00:31,  5.55it/s, Materializing param=model.layers.12.mlp.up_proj.weight]  Loading weights:  39%|███▉      | 114/291 [00:53<00:31,  5.55it/s, Materializing param=model.layers.12.mlp.up_proj.weight]Loading weights:  40%|███▉      | 115/291 [00:53<00:31,  5.55it/s, Materializing param=model.layers.12.post_attention_layernorm.weight]Loading weights:  40%|███▉      | 115/291 [00:53<00:31,  5.55it/s, Materializing param=model.layers.12.post_attention_layernorm.weight]Loading weights:  40%|███▉      | 116/291 [00:53<00:31,  5.55it/s, Materializing param=model.layers.12.self_attn.k_proj.weight]        Loading weights:  40%|███▉      | 116/291 [00:53<00:31,  5.55it/s, Materializing param=model.layers.12.self_attn.k_proj.weight]Loading weights:  40%|████      | 117/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.k_proj.weight]Loading weights:  40%|████      | 117/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.o_proj.weight]Loading weights:  40%|████      | 117/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.o_proj.weight]Loading weights:  41%|████      | 118/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.q_proj.weight]Loading weights:  41%|████      | 118/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.q_proj.weight]Loading weights:  41%|████      | 119/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.v_proj.weight]Loading weights:  41%|████      | 119/291 [00:53<00:13, 13.22it/s, Materializing param=model.layers.12.self_attn.v_proj.weight]Loading weights:  41%|████      | 120/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.input_layernorm.weight] Loading weights:  41%|████      | 120/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.input_layernorm.weight]Loading weights:  42%|████▏     | 121/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.mlp.down_proj.weight]  Loading weights:  42%|████▏     | 121/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.mlp.down_proj.weight]Loading weights:  42%|████▏     | 122/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.mlp.gate_proj.weight]Loading weights:  42%|████▏     | 122/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.mlp.gate_proj.weight]Loading weights:  42%|████▏     | 123/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.mlp.up_proj.weight]  Loading weights:  42%|████▏     | 123/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.mlp.up_proj.weight]Loading weights:  43%|████▎     | 124/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.post_attention_layernorm.weight]Loading weights:  43%|████▎     | 124/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.post_attention_layernorm.weight]Loading weights:  43%|████▎     | 125/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.k_proj.weight]        Loading weights:  43%|████▎     | 125/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.k_proj.weight]Loading weights:  43%|████▎     | 126/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.o_proj.weight]Loading weights:  43%|████▎     | 126/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.o_proj.weight]Loading weights:  44%|████▎     | 127/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.q_proj.weight]Loading weights:  44%|████▎     | 127/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.q_proj.weight]Loading weights:  44%|████▍     | 128/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.v_proj.weight]Loading weights:  44%|████▍     | 128/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.13.self_attn.v_proj.weight]Loading weights:  44%|████▍     | 129/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.input_layernorm.weight] Loading weights:  44%|████▍     | 129/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.input_layernorm.weight]Loading weights:  45%|████▍     | 130/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.mlp.down_proj.weight]  Loading weights:  45%|████▍     | 130/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.mlp.down_proj.weight]Loading weights:  45%|████▌     | 131/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.mlp.gate_proj.weight]Loading weights:  45%|████▌     | 131/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.mlp.gate_proj.weight]Loading weights:  45%|████▌     | 132/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.mlp.up_proj.weight]  Loading weights:  45%|████▌     | 132/291 [00:53<00:12, 13.22it/s, Materializing param=model.layers.14.mlp.up_proj.weight]Loading weights:  46%|████▌     | 133/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.post_attention_layernorm.weight]Loading weights:  46%|████▌     | 133/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.post_attention_layernorm.weight]Loading weights:  46%|████▌     | 134/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.k_proj.weight]        Loading weights:  46%|████▌     | 134/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.k_proj.weight]Loading weights:  46%|████▋     | 135/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.o_proj.weight]Loading weights:  46%|████▋     | 135/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.o_proj.weight]Loading weights:  47%|████▋     | 136/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.q_proj.weight]Loading weights:  47%|████▋     | 136/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.q_proj.weight]Loading weights:  47%|████▋     | 137/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.v_proj.weight]Loading weights:  47%|████▋     | 137/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.14.self_attn.v_proj.weight]Loading weights:  47%|████▋     | 138/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.input_layernorm.weight] Loading weights:  47%|████▋     | 138/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.input_layernorm.weight]Loading weights:  48%|████▊     | 139/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.mlp.down_proj.weight]  Loading weights:  48%|████▊     | 139/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.mlp.down_proj.weight]Loading weights:  48%|████▊     | 140/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.mlp.gate_proj.weight]Loading weights:  48%|████▊     | 140/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.mlp.gate_proj.weight]Loading weights:  48%|████▊     | 141/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.mlp.up_proj.weight]  Loading weights:  48%|████▊     | 141/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.mlp.up_proj.weight]Loading weights:  49%|████▉     | 142/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.post_attention_layernorm.weight]Loading weights:  49%|████▉     | 142/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.post_attention_layernorm.weight]Loading weights:  49%|████▉     | 143/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.self_attn.k_proj.weight]        Loading weights:  49%|████▉     | 143/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.self_attn.k_proj.weight]Loading weights:  49%|████▉     | 144/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.self_attn.o_proj.weight]Loading weights:  49%|████▉     | 144/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.self_attn.o_proj.weight]Loading weights:  50%|████▉     | 145/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.self_attn.q_proj.weight]Loading weights:  50%|████▉     | 145/291 [00:53<00:11, 13.22it/s, Materializing param=model.layers.15.self_attn.q_proj.weight]Loading weights:  50%|█████     | 146/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.15.self_attn.v_proj.weight]Loading weights:  50%|█████     | 146/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.15.self_attn.v_proj.weight]Loading weights:  51%|█████     | 147/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.input_layernorm.weight] Loading weights:  51%|█████     | 147/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.input_layernorm.weight]Loading weights:  51%|█████     | 148/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.mlp.down_proj.weight]  Loading weights:  51%|█████     | 148/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.mlp.down_proj.weight]Loading weights:  51%|█████     | 149/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.mlp.gate_proj.weight]Loading weights:  51%|█████     | 149/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.mlp.gate_proj.weight]Loading weights:  52%|█████▏    | 150/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.mlp.up_proj.weight]  Loading weights:  52%|█████▏    | 150/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.mlp.up_proj.weight]Loading weights:  52%|█████▏    | 151/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.post_attention_layernorm.weight]Loading weights:  52%|█████▏    | 151/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.post_attention_layernorm.weight]Loading weights:  52%|█████▏    | 152/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.k_proj.weight]        Loading weights:  52%|█████▏    | 152/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.k_proj.weight]Loading weights:  53%|█████▎    | 153/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.o_proj.weight]Loading weights:  53%|█████▎    | 153/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.o_proj.weight]Loading weights:  53%|█████▎    | 154/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.q_proj.weight]Loading weights:  53%|█████▎    | 154/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.q_proj.weight]Loading weights:  53%|█████▎    | 155/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.v_proj.weight]Loading weights:  53%|█████▎    | 155/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.16.self_attn.v_proj.weight]Loading weights:  54%|█████▎    | 156/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.17.input_layernorm.weight] Loading weights:  54%|█████▎    | 156/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.17.input_layernorm.weight]Loading weights:  54%|█████▍    | 157/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.17.mlp.down_proj.weight]  Loading weights:  54%|█████▍    | 157/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.17.mlp.down_proj.weight]Loading weights:  54%|█████▍    | 158/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.17.mlp.gate_proj.weight]Loading weights:  54%|█████▍    | 158/291 [00:53<00:10, 13.22it/s, Materializing param=model.layers.17.mlp.gate_proj.weight]Loading weights:  55%|█████▍    | 159/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.mlp.up_proj.weight]  Loading weights:  55%|█████▍    | 159/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.mlp.up_proj.weight]Loading weights:  55%|█████▍    | 160/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.post_attention_layernorm.weight]Loading weights:  55%|█████▍    | 160/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.post_attention_layernorm.weight]Loading weights:  55%|█████▌    | 161/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.k_proj.weight]        Loading weights:  55%|█████▌    | 161/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.k_proj.weight]Loading weights:  56%|█████▌    | 162/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.o_proj.weight]Loading weights:  56%|█████▌    | 162/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.o_proj.weight]Loading weights:  56%|█████▌    | 163/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.q_proj.weight]Loading weights:  56%|█████▌    | 163/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.q_proj.weight]Loading weights:  56%|█████▋    | 164/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.v_proj.weight]Loading weights:  56%|█████▋    | 164/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.17.self_attn.v_proj.weight]Loading weights:  57%|█████▋    | 165/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.input_layernorm.weight] Loading weights:  57%|█████▋    | 165/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.input_layernorm.weight]Loading weights:  57%|█████▋    | 166/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.mlp.down_proj.weight]  Loading weights:  57%|█████▋    | 166/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.mlp.down_proj.weight]Loading weights:  57%|█████▋    | 167/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.mlp.gate_proj.weight]Loading weights:  57%|█████▋    | 167/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.mlp.gate_proj.weight]Loading weights:  58%|█████▊    | 168/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.mlp.up_proj.weight]  Loading weights:  58%|█████▊    | 168/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.mlp.up_proj.weight]Loading weights:  58%|█████▊    | 169/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.post_attention_layernorm.weight]Loading weights:  58%|█████▊    | 169/291 [00:53<00:09, 13.22it/s, Materializing param=model.layers.18.post_attention_layernorm.weight]Loading weights:  58%|█████▊    | 170/291 [00:53<00:05, 24.00it/s, Materializing param=model.layers.18.post_attention_layernorm.weight]Loading weights:  58%|█████▊    | 170/291 [00:53<00:05, 24.00it/s, Materializing param=model.layers.18.self_attn.k_proj.weight]        Loading weights:  58%|█████▊    | 170/291 [00:53<00:05, 24.00it/s, Materializing param=model.layers.18.self_attn.k_proj.weight]Loading weights:  59%|█████▉    | 171/291 [00:53<00:05, 24.00it/s, Materializing param=model.layers.18.self_attn.o_proj.weight]Loading weights:  59%|█████▉    | 171/291 [00:53<00:05, 24.00it/s, Materializing param=model.layers.18.self_attn.o_proj.weight]Loading weights:  59%|█████▉    | 172/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.18.self_attn.q_proj.weight]Loading weights:  59%|█████▉    | 172/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.18.self_attn.q_proj.weight]Loading weights:  59%|█████▉    | 173/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.18.self_attn.v_proj.weight]Loading weights:  59%|█████▉    | 173/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.18.self_attn.v_proj.weight]Loading weights:  60%|█████▉    | 174/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.input_layernorm.weight] Loading weights:  60%|█████▉    | 174/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.input_layernorm.weight]Loading weights:  60%|██████    | 175/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.mlp.down_proj.weight]  Loading weights:  60%|██████    | 175/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.mlp.down_proj.weight]Loading weights:  60%|██████    | 176/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.mlp.gate_proj.weight]Loading weights:  60%|██████    | 176/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.mlp.gate_proj.weight]Loading weights:  61%|██████    | 177/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.mlp.up_proj.weight]  Loading weights:  61%|██████    | 177/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.mlp.up_proj.weight]Loading weights:  61%|██████    | 178/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.post_attention_layernorm.weight]Loading weights:  61%|██████    | 178/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.post_attention_layernorm.weight]Loading weights:  62%|██████▏   | 179/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.k_proj.weight]        Loading weights:  62%|██████▏   | 179/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.k_proj.weight]Loading weights:  62%|██████▏   | 180/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.o_proj.weight]Loading weights:  62%|██████▏   | 180/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.o_proj.weight]Loading weights:  62%|██████▏   | 181/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.q_proj.weight]Loading weights:  62%|██████▏   | 181/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.q_proj.weight]Loading weights:  63%|██████▎   | 182/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.v_proj.weight]Loading weights:  63%|██████▎   | 182/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.19.self_attn.v_proj.weight]Loading weights:  63%|██████▎   | 183/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.input_layernorm.weight] Loading weights:  63%|██████▎   | 183/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.input_layernorm.weight]Loading weights:  63%|██████▎   | 184/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.mlp.down_proj.weight]  Loading weights:  63%|██████▎   | 184/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.mlp.down_proj.weight]Loading weights:  64%|██████▎   | 185/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.mlp.gate_proj.weight]Loading weights:  64%|██████▎   | 185/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.mlp.gate_proj.weight]Loading weights:  64%|██████▍   | 186/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.mlp.up_proj.weight]  Loading weights:  64%|██████▍   | 186/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.mlp.up_proj.weight]Loading weights:  64%|██████▍   | 187/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.post_attention_layernorm.weight]Loading weights:  64%|██████▍   | 187/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.post_attention_layernorm.weight]Loading weights:  65%|██████▍   | 188/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.k_proj.weight]        Loading weights:  65%|██████▍   | 188/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.k_proj.weight]Loading weights:  65%|██████▍   | 189/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.o_proj.weight]Loading weights:  65%|██████▍   | 189/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.o_proj.weight]Loading weights:  65%|██████▌   | 190/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.q_proj.weight]Loading weights:  65%|██████▌   | 190/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.q_proj.weight]Loading weights:  66%|██████▌   | 191/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.v_proj.weight]Loading weights:  66%|██████▌   | 191/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.20.self_attn.v_proj.weight]Loading weights:  66%|██████▌   | 192/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.input_layernorm.weight] Loading weights:  66%|██████▌   | 192/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.input_layernorm.weight]Loading weights:  66%|██████▋   | 193/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.mlp.down_proj.weight]  Loading weights:  66%|██████▋   | 193/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.mlp.down_proj.weight]Loading weights:  67%|██████▋   | 194/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.mlp.gate_proj.weight]Loading weights:  67%|██████▋   | 194/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.mlp.gate_proj.weight]Loading weights:  67%|██████▋   | 195/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.mlp.up_proj.weight]  Loading weights:  67%|██████▋   | 195/291 [00:53<00:04, 24.00it/s, Materializing param=model.layers.21.mlp.up_proj.weight]Loading weights:  67%|██████▋   | 196/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.post_attention_layernorm.weight]Loading weights:  67%|██████▋   | 196/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.post_attention_layernorm.weight]Loading weights:  68%|██████▊   | 197/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.k_proj.weight]        Loading weights:  68%|██████▊   | 197/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.k_proj.weight]Loading weights:  68%|██████▊   | 198/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.o_proj.weight]Loading weights:  68%|██████▊   | 198/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.o_proj.weight]Loading weights:  68%|██████▊   | 199/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.q_proj.weight]Loading weights:  68%|██████▊   | 199/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.q_proj.weight]Loading weights:  69%|██████▊   | 200/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.v_proj.weight]Loading weights:  69%|██████▊   | 200/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.21.self_attn.v_proj.weight]Loading weights:  69%|██████▉   | 201/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.22.input_layernorm.weight] Loading weights:  69%|██████▉   | 201/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.22.input_layernorm.weight]Loading weights:  69%|██████▉   | 202/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.22.mlp.down_proj.weight]  Loading weights:  69%|██████▉   | 202/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.22.mlp.down_proj.weight]Loading weights:  70%|██████▉   | 203/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.22.mlp.gate_proj.weight]Loading weights:  70%|██████▉   | 203/291 [00:53<00:03, 24.00it/s, Materializing param=model.layers.22.mlp.gate_proj.weight]Loading weights:  70%|██████▉   | 203/291 [00:53<00:23,  3.78it/s, Materializing param=model.layers.22.mlp.gate_proj.weight]
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/mnt/data/lhe339/memory-z-rag/train/run.py", line 188, in <module>
    main()
    ~~~~^^
  File "/mnt/data/lhe339/memory-z-rag/train/run.py", line 58, in main
    model = ZModel(
        config["llm_name"], num_segments=len(seg_ids),
    ...<2 lines>...
        projector_dropout=config.get("projector_dropout", 0.0),
    )
  File "/mnt/data/lhe339/memory-z-rag/model/z_model.py", line 30, in __init__
    self.llm = AutoModelForCausalLM.from_pretrained(
               ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        llm_name,
        ^^^^^^^^^
    ...<3 lines>...
        trust_remote_code=True,
        ^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/models/auto/auto_factory.py", line 374, in from_pretrained
    return model_class.from_pretrained(
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        pretrained_model_name_or_path, *model_args, config=config, **hub_kwargs, **kwargs
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/modeling_utils.py", line 4072, in from_pretrained
    loading_info, disk_offload_index = cls._load_pretrained_model(model, state_dict, checkpoint_files, load_config)
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/modeling_utils.py", line 4191, in _load_pretrained_model
    loading_info, disk_offload_index = convert_and_load_state_dict_in_model(
                                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        model=model,
        ^^^^^^^^^^^^
    ...<3 lines>...
        disk_offload_index=disk_offload_index,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/core_model_loading.py", line 1209, in convert_and_load_state_dict_in_model
    realized_value = mapping.convert(
        first_param_name,
    ...<3 lines>...
        loading_info=loading_info,
    )
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/core_model_loading.py", line 677, in convert
    collected_tensors = self.materialize_tensors()
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/core_model_loading.py", line 653, in materialize_tensors
    tensors = [future.result() for future in tensors if future.result() is not None]
                                                        ~~~~~~~~~~~~~^^
  File "/home/lhe339/.local/share/uv/python/cpython-3.14.2-linux-x86_64-gnu/lib/python3.14/concurrent/futures/_base.py", line 443, in result
    return self.__get_result()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/lhe339/.local/share/uv/python/cpython-3.14.2-linux-x86_64-gnu/lib/python3.14/concurrent/futures/_base.py", line 395, in __get_result
    raise self._exception
  File "/home/lhe339/.local/share/uv/python/cpython-3.14.2-linux-x86_64-gnu/lib/python3.14/concurrent/futures/thread.py", line 86, in run
    result = ctx.run(self.task)
  File "/home/lhe339/.local/share/uv/python/cpython-3.14.2-linux-x86_64-gnu/lib/python3.14/concurrent/futures/thread.py", line 73, in run
    return fn(*args, **kwargs)
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/core_model_loading.py", line 799, in _job
    return _materialize_copy(tensor, device, dtype)
  File "/mnt/data/lhe339/memory-z-rag/.venv/lib/python3.14/site-packages/transformers/core_model_loading.py", line 788, in _materialize_copy
    tensor = tensor.to(device=device, dtype=dtype)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 112.00 MiB. GPU 0 has a total capacity of 21.95 GiB of which 21.00 MiB is free. Including non-PyTorch memory, this process has 10.98 GiB memory in use. Process 528189 has 10.94 GiB memory in use. Of the allocated memory 10.71 GiB is allocated by PyTorch, and 64.15 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
